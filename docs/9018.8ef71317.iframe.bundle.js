"use strict";(self.webpackChunk_iot_app_kit_doc_site=self.webpackChunk_iot_app_kit_doc_site||[]).push([[9018],{"../packages/components/dist/esm/iot-resource-explorer.entry.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{iot_resource_explorer:()=>IotResourceExplorer});var _index_7d5b2a6a_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../packages/components/dist/esm/index-7d5b2a6a.js"),_resolution_0967f648_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../packages/components/dist/esm/resolution-0967f648.js");__webpack_require__("../packages/components/dist/esm/_commonjsHelpers-f9dc4873.js");const recursiveParseSitewiseAssetTree=(flattenTree,subTree,parentId)=>{subTree.forEach((node=>{flattenTree.push(Object.assign(Object.assign({},node.asset),{hasChildren:node.hierarchies.size>0,parentId})),node.hierarchies.forEach((hierarchy=>{recursiveParseSitewiseAssetTree(flattenTree,hierarchy.children,node.asset.id)}))}))};let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const byteToHex=[];for(let i=0;i<256;++i)byteToHex.push((i+256).toString(16).slice(1));const native={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function v4(options,buf,offset){if(native.randomUUID&&!buf&&!options)return native.randomUUID();const rnds=(options=options||{}).random||(options.rng||rng)();if(rnds[6]=15&rnds[6]|64,rnds[8]=63&rnds[8]|128,buf){offset=offset||0;for(let i=0;i<16;++i)buf[offset+i]=rnds[i];return buf}return function unsafeStringify(arr,offset=0){return(byteToHex[arr[offset+0]]+byteToHex[arr[offset+1]]+byteToHex[arr[offset+2]]+byteToHex[arr[offset+3]]+"-"+byteToHex[arr[offset+4]]+byteToHex[arr[offset+5]]+"-"+byteToHex[arr[offset+6]]+byteToHex[arr[offset+7]]+"-"+byteToHex[arr[offset+8]]+byteToHex[arr[offset+9]]+"-"+byteToHex[arr[offset+10]]+byteToHex[arr[offset+11]]+byteToHex[arr[offset+12]]+byteToHex[arr[offset+13]]+byteToHex[arr[offset+14]]+byteToHex[arr[offset+15]]).toLowerCase()}(rnds)}const DEFAULT_COLUMNS=[{sortingField:"name",id:"name",header:"Asset Name",cell:({name})=>name},{sortingField:"status",id:"status",header:"Status",cell:({status})=>null==status?void 0:status.state},{sortingField:"creationDate",id:"creationDate",header:"Created",cell:({creationDate})=>null==creationDate?void 0:creationDate.toUTCString()},{sortingField:"lastUpdateDate",id:"lastUpdateDate",header:"Updated",cell:({lastUpdateDate})=>null==lastUpdateDate?void 0:lastUpdateDate.toUTCString()}],IotResourceExplorer=class{constructor(hostRef){(0,_index_7d5b2a6a_js__WEBPACK_IMPORTED_MODULE_0__.r)(this,hostRef),this.columnDefinitions=DEFAULT_COLUMNS,this.filterEnabled=!0,this.sortingEnabled=!0,this.paginationEnabled=!0,this.wrapLines=!1,this.widgetId=v4(),this.expanded=!1,this.items=[],this.expandedItems={},this.errors=[],this.defaults={selectionType:"single",loadingText:"loading...",filterText:{placeholder:"Filter by name",empty:"No assets found.",noMatch:"We can't find a match."},empty:{header:"No assets",description:"You don't have any asset."}},this.expandNode=node=>{var _a;null===(_a=node.hierarchies)||void 0===_a||_a.forEach((hierarchy=>{this.provider.expand(new _resolution_0967f648_js__WEBPACK_IMPORTED_MODULE_1__.B(node.id,hierarchy.id))}))}}buildProvider(){return this.query.build(this.widgetId)}componentWillLoad(){this.provider=this.buildProvider(),this.provider.subscribe({next:data=>{this.items=(tree=>{const flattenTree=[];return recursiveParseSitewiseAssetTree(flattenTree,tree),flattenTree})(data)},error:err=>{this.errors=err}})}componentWillUnmount(){this.provider.unsubscribe()}watchItems(newItems){if(this.expanded){const newExpandedItems={};newItems.forEach((({id,hierarchies,hasChildren})=>{!this.expandedItems[id]&&hasChildren&&(null==hierarchies||hierarchies.forEach((hierarchy=>{this.provider.expand(new _resolution_0967f648_js__WEBPACK_IMPORTED_MODULE_1__.B(id,hierarchy.id))})),newExpandedItems[id]=!0)})),this.expandedItems=Object.assign(Object.assign({},this.expandedItems),newExpandedItems)}}render(){var _a;const filtering=this.filterEnabled?this.filterTexts||this.defaults.filterText:void 0,collectionOptions={columnDefinitions:this.columnDefinitions,keyPropertyName:"id",parentKeyPropertyName:"parentId",selection:{keepSelection:!0},sorting:{defaultState:{sortingColumn:{sortingField:"name"},isDescending:!0}},filtering};this.paginationEnabled&&(collectionOptions.pagination={pageSize:20});let empty=this.defaults.empty;return this.empty&&(empty=this.empty),this.errors.length>0&&(empty={header:"Error",description:null===(_a=this.errors[this.errors.length-1])||void 0===_a?void 0:_a.msg}),(0,_index_7d5b2a6a_js__WEBPACK_IMPORTED_MODULE_0__.h)("iot-tree-table",{items:this.items,collectionOptions,columnDefinitions:this.columnDefinitions,selectionType:this.selectionType||this.defaults.selectionType,loadingText:this.loadingText||this.defaults.loadingText,filterPlaceholder:null==filtering?void 0:filtering.placeholder,onExpandChildren:this.expandNode,onSelectionChange:this.onSelectionChange,empty,sortingDisabled:!this.sortingEnabled,wrapLines:this.wrapLines,expanded:this.expanded})}static get watchers(){return{items:["watchItems"]}}}}}]);